              PIPELINE   ( (C) Copyright Jerome Arvidsson, 1991 )

Det hÑr spelet finns till Mac'en och det finns nu Ñven till HP48SX.
Spelet gÜr ut pÜ att bygga en oljeledning ( pipeline ) sÜ lÜngt som
mîjligt. Fîr att klara en svÜrighetsgrad mÜste lÑngden vara stîrre Ñn
eller lika med 'length' som stÜr uppe i hîgra hîrnet. Om man klarar att
bygga lÑngre Ñn 'length' sÜ fÜr man denna skillnad tillgodo i nÑsta
svÜrighetsgrad. Det lînar sig alltsÜ att fortsÑtta Ñven om man har byggt
tillrÑckligt lÜngt fîr att klara nuvarande svÜrighetsgrad.
Spelet gÜr Ñven pÜ tid och man mÜste bygga fÑrdigt innan tiden har
tickat ner till noll.
LÑngst ner i vÑnstra hîrnet stÜr vilken svÜrighetsgrad som man befinner sig
pÜ fîr tillfÑllet med bîrjan frÜn 1. Det finns 17 olika svÜrighetsgrader.

Det finns tvÜ stycken "staplar" till vÑnster om rutnÑtet som innehÜller
byggbitar. Det Ñr bara den byggbiten som stÜr îverst i varje stapel som
man kan bygga med. DÜ man sÑtter ut nÜgon byggbit i en stapel sÜ flyttas
denna byggbiten till vald koordinat och de byggbitar som finns under flyttas
upp ett steg. Det gÑller alltsÜ att planera hur man skall bygga beroende pÜ
vilka bitar som finns i staplarna.

Till vÑnster pÜ skÑrmen stÜr det tvÜ symboler, '*' och "Pil Upp" med ett
nummer efter.
'*' stÜr fîr hur mÜnga sprÑngningar man kan gîra, dvs man kan ta bort
en felaktigt utsatt bit med denna funktion.
"Pil Upp" stÜr fîr hur mÜnga "roteringar" man kan gîra, dvs om det finns en
bit som man absolut inte behîver sÜ kan man flytta upp bitarna i en stapel
utan att nÜgon bit sÑtts ut i koordinatsystemet.
BÜde antalet sprÑngningar och antalet roteringar varierar pÜ de olika
svÜrighetsgraderna.
Det finns pÜ alla svÜrighetsgraderna en startbit som oljeledningen ska
utgÜ ifrÜn. Det finns sedan pÜ hîgre svÜrighetsgrader Ñven en slutbit
som oljeledningen ska gÜ fram till.

Man spelar (lÑmpligen) spelet pÜ fîljande vis:
Man bestÑmmer sig fîr var man vill sÑtta ut en byggbit.
Detta gîrs genom att fîrst trycka en tangent 1,2,3,... ,9 vilket Ñr
X-koordinaten. DÑrefter trycker man en tangent 1,2,3,... ,7 vilket Ñr
Y-koordinaten.
Efter detta bestÑmmer man sig fîr vilken stapel biten skall tas ifrÜn.
Tangenten '+/-' tar biten frÜn den vÑnstra stapeln och tangenten 'EEX' tar
biten frÜn den hîgra stapeln.
Man kan nÑr som helst efter att ha tryckt pÜ fel tangent trycka pÜ tangenten
'.' och kommer dÜ tillbaka till ursprungslÑget.
Om man vill sprÑnga en bit trycker man in koordinaterna enl. ovan men man
trycker dÑrefter pÜ tangenten 'SPC' istÑllet fîr att vÑlja en stapel.
Fîr att rotera en stapel trycker man pÜ tangenten '0' och vÑljer dÑrefter
en stapel som skall roteras med tangenterna '+/-' eller 'EEX' fîr vÑnster
resp. hîger stapel.
Man kan Ñven hÑr Üngra sig genom att trycka pÜ tangenten '.'.

Mycket nîje med detta fantastiskt roliga ( och svÜra ) spel.

------------------------- Cut here ------------------------

%%HP: T(1)A(D)F(.);
DIR
  UPê
    ´ UPDIR
    ª
  PIPE
    ´ -40 CF CLEAR
CLLCD 1 0 ç LEV
LANGD
      ´ { # 0d # 0d
} PVIEW PICT { # 0d
# 0d } STPIC REPL 3
WAIT
        DO PICT {
# 0d # 0d } SPPL
REPL 1 63
          START 0
          NEXT 63
çLIST 0 0 LEVEL LEV
GET OBJç DROP 0 0 0
0 1 ç SPP X Y TIM
LE SH KI EN BL LV
LH STID TL NU
          ´ LE
LANGD + 'LE' STO
PICT { # 87d # 7d }
"TIME: " TIM çSTR +
1 çGROB REPL PICT {
# 87d # 15d }
"LENGTH: " LE çSTR
+ 1 çGROB REPL PICT
{ # 116d # 23d }
"§: " KI + 1 çGROB
REPL PICT { # 115d
# 31d } "ê: " SH +
1 çGROB REPL PICT {
# 117d # 44d } LEV
çSTR 3 çGROB REPL 3
7
            FOR J
RAND 7 * IP 1 + DUP
"P" SWAP + OBJç
PICT SWAP { # 88d 0
} 2 J 8 * RçB PUT
SWAP REPL
            NEXT 5
çLIST 'LV' STO 3 7
            FOR J
RAND 7 * IP 1 + DUP
"P" SWAP + OBJç
PICT SWAP { # 104d
0 } 2 J 8 * RçB PUT
SWAP REPL
            NEXT 5
çLIST 'LH' STO SPP
RAND 8 * IP 1 + 'X'
STO RAND 7 * IP 1 +
'Y' STO Y 1 - 9 * X
+ 8 PUT 'SPP' STO
PICT { 0 0 } 1 X 8
* RçB PUT 2 Y 8 *
RçB PUT ST REPL
            IF EN
            THEN 0
0
              DO
DROP2 RAND 8 * IP 2
+ RAND 7 * IP 1 +
DUP2
              UNTIL
Y == SWAP X 1 + ==
AND NOT
              END
'Y' STO 'X' STO SPP
Y 1 - 9 * X + 9 PUT
'SPP' STO PICT { 0
0 } 1 X 8 * RçB PUT
2 Y 8 * RçB PUT
ENDB REPL
            END
            IF BL
            THEN 1
20
              START
RAND 7 * IP 1 + 'Y'
STO RAND 9 * IP 1 +
'X' STO SPP Y 1 - 9
* X + GET
IF 0 ==
THEN SPP Y 1 - 9 *
X + 10 PUT 'SPP'
STO PICT { 0 0 } 1
X 8 * RçB PUT 2 Y 8
* RçB PUT BLK REPL
END
              NEXT
            END
TICKS 'STID' STO
            IF
# 37046d 'LEVEL'
BYTES DROP ã
            THEN
              DO 0
              UNTIL
              END
            END
            DO 0
              DO
DROP
DO KEY TIM STID TID
'TL' STO TL
UNTIL 0 == OR
END
IF DEPTH 0 ==
THEN 62
END OMV DUP
IF "S" SAME SH 0 >
AND
THEN LV LH TIM STID
SH SHIFT 'TL' STO
'LV' STO 'LH' STO
'SH' STO
END
              UNTIL
DUP DUP "9" â SWAP
"1" ä AND TL NOT OR
              END
OBJç 'X' STO
              IF TL
              THEN
X REVX
              END
              IF TL
              THEN
0
DO DROP
  DO KEY TIM STID
TID 'TL' STO TL
  UNTIL 0 == OR
  END
  IF DEPTH 0 ==
  THEN 62
  END OMV DUP
  IF "U" SAME
  THEN 0 'NU' STO
  END
UNTIL DUP DUP "1" ä
SWAP "7" â AND NU
NOT OR
END
IF TL
THEN
  IF NU
  THEN OBJç 'Y' STO
Y REVY
  ELSE DROP X REVX
  END
ELSE DROP
END
              END
              IF TL
NU AND
              THEN
0
DO DROP
  DO KEY TIM STID
TID 'TL' STO TL
  UNTIL 0 == OR
  END
  IF DEPTH 0 ==
  THEN 62
  END OMV DUP
UNTIL "LRKU" SWAP
POS TL NOT OR
END
CASE DUP "L" ==
  THEN SPP Y 1 - 9
* X + DUP 3 ROLLD
GET
    IF 0 ==
    THEN PICT X
# 8d * Y # 8d * 2
çLIST "P" LV 1 GET
+ OBJç REPL SPP
SWAP LV 1 GET PUT
'SPP' STO LV 0
SHGFX 'LV' STO
    ELSE DROP
    END X REVX Y
REVY DROP
  END DUP "R" ==
  THEN SPP Y 1 - 9
* X + DUP 3 ROLLD
GET
    IF 0 ==
    THEN PICT X
# 8d * Y # 8d * 2
çLIST "P" LH 1 GET
+ OBJç REPL SPP
SWAP LH 1 GET PUT
'SPP' STO LH 1
SHGFX 'LH' STO
    ELSE DROP
    END X REVX Y
REVY DROP
  END "K" ==
  THEN SPP Y 1 - 9
* X + DUP 3 ROLLD
GET
    IF DUP DUP 7 â
SWAP 10 == OR SWAP
0 ã AND KI 1 ä AND
    THEN PICT X
# 8d * Y # 8d * 2
çLIST # 7d DUP
BLANK REPL SPP SWAP
0 PUT 'SPP' STO KI
1 - 'KI' STO PICT {
# 127d # 23d } KI
çSTR 1 çGROB REPL
    ELSE DROP
    END X REVX Y
REVY
  END X REVX Y REVY
END
              END 1
'NU' STO
            UNTIL
TL NOT
            END SPP
EN LE OLJA 'LANGD'
STO
          ª LEV 1 +
'LEV' STO
          IF LEV 18
==
          THEN TEXT
"  WELL DONE, MASTER"
3 DISP 10 WAIT DROP
0
          END
        UNTIL NOT
        END LEV
      ª -40 SF
      IF 18 ã
      THEN TEXT
"      GAME OVER" 3
DISP 3 WAIT
      END
    ª
  OLJA
    ´ 0 0 0 0 0 ç
SPP EN LE RIKT KLAR
X Y BIT
      ´ PICT {
# 87d # 7d } # 25d
# 5d BLANK REPL
PICT { # 115d # 23d
} # 15d # 13d BLANK
REPL SPP 8 POS DUP
1 - 9 / IP 1 + 'Y'
STO Y 1 - 9 * - 'X'
STO PICT X # 8d * Y
# 8d * 2 çLIST FST
REPL
        DO
          CASE RIKT
0 ==
            THEN X
1 + 'X' STO
            END
RIKT 1 ==
            THEN Y
1 + 'Y' STO
            END
RIKT 2 ==
            THEN X
1 - 'X' STO
            END
RIKT 3 ==
            THEN Y
1 - 'Y' STO
            END
          END
          IF X 9 >
X 1 < OR
          THEN 1
'KLAR' STO
          END
          IF Y 7 >
Y 1 < OR
          THEN 1
'KLAR' STO
          END
          IF KLAR
NOT
          THEN SPP
Y 1 - 9 * X + GET
'BIT' STO
            IF BIT
0 ã BIT 10 ã AND
BIT 8 ã AND
            THEN
              IF
BIT 7 <
              THEN
LATH BIT GET OBJç
DROP DROP2
IF RIKT ==
THEN LATH BIT GET 4
GET 'RIKT' STO DROP
ELSE
  IF RIKT ==
  THEN LATH BIT GET
3 GET 'RIKT' STO
  ELSE 1 'KLAR' STO
  END
END
              ELSE
IF BIT 7 ==
THEN PICT X # 8d *
Y # 8d * 2 çLIST
  IF RIKT 0 == RIKT
2 == OR
  THEN FP70
  ELSE FP71
  END GOR
END
IF BIT 9 ==
THEN PICT X # 8d *
Y # 8d * 2 çLIST
FENB REPL 1 'KLAR'
STO
END
              END
            ELSE 1
'KLAR' STO
            END
          END
          IF KLAR
NOT BIT 7 ã AND
          THEN PICT
X # 8d * Y # 8d * 2
çLIST "FP" BIT +
OBJç REPL
          END
          IF KLAR
NOT
          THEN LE 1
- 'LE' STO PICT {
# 119d # 15d } LE
çSTR " " + 1 çGROB
REPL
          END
        UNTIL KLAR
        END 1 63
        FOR J SPP J
GET DUP
          IF 7 â
SWAP 1 ä AND
          THEN J 1
- 9 / IP 1 + RçB
DUP 8 * 'Y' STO 1 -
9 * J SWAP - 8 *
'X' STO X 3 + Y 2
çLIST PIX? X Y 3 +
2 çLIST PIX? X 3 +
Y 6 + 2 çLIST PIX?
X 6 + Y 3 + 2 çLIST
PIX?
            IF OR
OR OR NOT
            THEN
PICT X Y 2 çLIST
# 7d DUP BLANK REPL
LE 1 + 'LE' STO
PICT { # 119d # 15d
} LE çSTR " " + 1
çGROB REPL
            END
          END
        NEXT
        IF EN
        THEN
          IF BIT 9
== LE 0 â AND
          THEN 1
          ELSE 0
          END
        ELSE
          IF LE 0 â
          THEN 1
          ELSE 0
          END
        END
        IF 'LEVEL'
BYTES DROP # 37046d
ã
        THEN DROP 0
        END LE
      ª
      WHILE KEY
      REPEAT DROP
      END
    ª
  SHGFX
    ´ ç L VH
      ´ L 2 5 SUB
RAND 7 * IP 1 + 1
çLIST + 'L' STO 0 4
        FOR J VH 16
* 88 + RçB J 8 * 24
+ RçB 2 çLIST PICT
SWAP "P" L J 1 +
GET + OBJç REPL
        NEXT L
      ª
    ª
  SHIFT
    ´ 0 ç LV LH TIM
STID SH TL
      ´ PICT {
# 87d # 0d }
"SHIFT" 1 çGROB
REPL 0
        DO DROP
          DO KEY
TIM STID TID 'TL'
STO TL
          UNTIL 0
== OR
          END
          IF DEPTH
1 ==
          THEN 62
          END OMV
DUP
        UNTIL "ULR"
SWAP POS TL NOT OR
        END DUP
        IF "L" SAME
        THEN LV 0
SHGFX 'LV' STO SH 1
- 'SH' STO
        END
        IF "R" SAME
        THEN LH 1
SHGFX 'LH' STO SH 1
- 'SH' STO
        END PICT {
# 127d # 31d } SH
çSTR 1 çGROB REPL
SH LH LV TL PICT {
# 87d # 0d }
"     " 1 çGROB
REPL
      ª
    ª
  REVX
    ´ # 8d * 1 -
# 0d 2 çLIST PICT
SWAP
GROB 9 7 FF10FF10FF10FF10FF10FF10FF10
GXOR
    ª
  REVY
    ´ # 8d * 1 -
# 0d SWAP 2 çLIST
PICT SWAP
GROB 7 9 F7F7F7F7F7F7F7F7F7
GXOR
    ª
  STPIC
GROB 131 64 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000FF30EFF1FF30EFF7C3008FF7C70E1FFF30FFF0EFF1FFF0EFF7C3008FF7CF0E1FFF30FFF1EFF1FFF1EFF7C3008FF7CF0E1FFF30FFF1EFF1FFF1EFF7C3008FF7CF1E1FFF30F0F30E10F0F3E100C3000870CF1E1F0000F0C30E10F0C3E100C3000870CF1E1F0000F0C30E10F0C3E100C3000870CF3E1F0000F0C30E10F0C3E100C3000870CF3E1F0000F0C30E10F0C3E100C3000870CF3E1F0000F0F30E10F0F3E100C3000870CF7E1F0000FFF10E10FFF1EFF1C3000870CB7E1FFF00FFF10E10FFF1EFF1C3000870CB7E1FFF00FFF00E10FFF0EFF1C3000870CBFE1FFF00FF300E10FF30EFF1C3000870C3FE1FFF00F0000E10F000E100C3000870C3FE1F0000F0000E10F000E100C3000870C3FF1F0000F0000E10F000E100C3000870C3EF1F0000F0000E10F000E100C3000870C3EF1F0000F0000E10F000E100C3000870C3EF1F0000F0000E10F000E100C3000870C3CF1F0000F0000E10F000E100C3000870C3CF1F0000F000EFF1F000EFF7CFFF8FF7C3CF1FFF30F000EFF1F000EFF7CFFF8FF7C38F1FFF30F000EFF1F000EFF7CFFF8FF7C38F1FFF30F000EFF1F000EFF7CFFF8FF7C30F1FFF30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF70FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF70FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF70FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000087000020000000007000000000000000008800002000000008800000000000000000880000200000000880000000000000000088220027A3761708800000000000000000872200A8688AA808F00000000000000000882202AF288AAF0880000000000000000088C302A0288AA008800000000000000000880202A02882A0088C000000000000000087020C17207227088C000000000000000000C1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
  NUFF { { "0" "0"
"0" "0" "0" "0" } {
"0" "0" "0" "0" "0"
"0" } { "0" "0" "0"
"0" "0" "0" } { "0"
"0" "0" "0" "0" "0"
} { "0" "L" "R" "0"
"0" } { "0" "7" "8"
"9" "0" } { "0" "4"
"5" "6" "0" } { "0"
"1" "2" "3" "0" } {
"0" "S" "U" "K" "0"
} }
  OMV
    ´ 10 / DUP FP
10 * SWAP IP NUFF
SWAP GET SWAP GET
    ª
  LEVEL { { 60 9 4
3 0 0 } { 60 10 4 3
0 0 } { 60 11 3 2 0
0 } { 60 12 3 2 0 0
} { 70 9 4 3 0 1 }
{ 70 10 4 3 0 1 } {
70 11 3 3 0 1 } {
70 12 3 3 0 1 } {
60 9 3 3 1 0 } { 60
10 3 3 1 0 } { 60
11 2 3 1 0 } { 60
12 2 3 1 0 } { 100
12 3 3 1 1 } { 100
13 2 3 1 1 } { 100
14 2 2 1 1 } { 100
15 1 1 1 1 } { 120
20 1 2 1 1 } }
  TID
    ´ TICKS SWAP -
8192 / - BçR DUP
DUP
      IF 1000 >
      THEN DROP2 0
DUP
      END çSTR " "
+ PICT SWAP {
# 109d # 7d } SWAP
1 çGROB REPL
    ª
  SPPL
GROB 131 64 000000000000000000000000000000000000C0C1C141C181C1C1C10000000000000000800101414040014141000000000000000080C1C1C1C1C180C1C100000000000000008040010101414041010000000000000000C1C1C101C1C140C1C100000000000000000000000000000000000000000000000008FFFFFFFFFFFFFFFFFF000000000000000808080808080808080800000000000000C808080808080808080800000000000000880808080808080808080000000000000088080808080808080808000000000000008808080808080808080800000000000000C908080808080808080800000000000000080808080808080808080000000000000008FFFFFFFFFFFFFFFFFF000000000000000808080808080808080800000000000000C9080808080808080808000000000000000908080808080808080800000000000000C9080808080808080808000000000000004808080808080808080800000000000000C908080808080808080800000000000000080808080808080808080000000000000008FFFFFFFFFFFFFFFFFF08FF08FF0000000808080808080808080808080808000000C9080808080808080808080808080000000908080808080808080808080808000000C9080808080808080808080808080000000908080808080808080808080808000000C908080808080808080808080808000000080808080808080808080808080800000008FFFFFFFFFFFFFFFFFF08FF08FF000000080808080808080808080808080800000049080808080808080808080808080000004908080808080808080808080808000000C90808080808080808080808080800000009080808080808080808080808080000000908080808080808080808080808000000080808080808080808080808080800000008FFFFFFFFFFFFFFFFFF08FF08FF0000000808080808080808080808080808000000C9080808080808080808080808080000004808080808080808080808080808000000C9080808080808080808080808080000000908080808080808080808080808000000C908080808080808080808080808000000080808080808080808080808080800000008FFFFFFFFFFFFFFFFFF08FF08FF000000080808080808080808080808080800000089080808080808080808080808080000004808080808080808080808080808000000C9080808080808080808080808080000004908080808080808080808080808000000C908080808080808080808080808000000080808080808080808080808080800000008FFFFFFFFFFFFFFFFFF08FF08FF0000000808080808080808080808080808000000C9080808080808080808080808080000000908080808080808080808080808000000880808080808080808080808080800000048080808080808080808080808080000004808080808080808080808080808000000080808080808080808080808080800000008FFFFFFFFFFFFFFFFFF00000000000000
  LATH { { 0 3 1 2
} { 0 1 3 2 } { 1 2
0 3 } { 2 3 1 0 } {
1 3 1 3 } { 0 2 0 2
} }
  BLK
GROB 7 7 94A2C1F7C1A294
  ST
GROB 7 7 0000C740C70000
  ENDB
GROB 7 7 0000F101F10000
  P1
GROB 7 7 00003040902141
  P2
GROB 7 7 41219040300000
  P3
GROB 7 7 41428401060000
  P4
GROB 7 7 00000601844241
  P5
GROB 7 7 41414141414141
  P6
GROB 7 7 0000F700F70000
  P7
GROB 7 7 41417700774141
  FST
GROB 7 7 0000C7C7C70000
  FENB
GROB 7 7 0000F1F1F10000
  FP1
GROB 7 7 00003070F0E1C1
  FP2
GROB 7 7 C1E1F070300000
  FP3
GROB 7 7 C1C38707060000
  FP4
GROB 7 7 0000060787C3C1
  FP5
GROB 7 7 C1C1C1C1C1C1C1
  FP6
GROB 7 7 0000F7F7F70000
  FP70
GROB 7 7 4141F7F7F74141
  FP71
GROB 7 7 C1C1F7C1F7C1C1
  PPAR {
(-6.5,-3.1)
(6.5,3.2) X 0 (0,0)
FUNCTION Y }
  IERR
3.74926557206E-11
END
          