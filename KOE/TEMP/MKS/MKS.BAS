10 CLOSE 1:COLOR 7,0:CLS
20 ON ERROR GOTO 6700
30 KEY OFF
40 KEY 3,"":KEY 4,"":KEY 5,"":KEY 6,"":KEY 7,"":KEY 8,"":KEY 9,"":KEY 10,""
50 REM ************************************************************************
60 REM ***  (C) by KOELLIKER AG SPITALORGANISATION            S C H W E I Z ***
70 REM ************************************************************************
80 REM
90 REM MCS_1000/3 TEST Patientendatenerfassung
100 REM
110 REM ************************************************************************
120 REM ZUERICH 170288
130 REM written by W.H. KOELLIKER AG ZUERICH/SCHWEIZ
140 REM ***********************************************************************
150 REM
160 REM ***********************************************************************
170 REM Edition History
180 REM
190 REM no  date   name         command
200 REM --  ------ ------------ -----------------------------------------------
210 REM 01  200988 W.HOFER      version v 1.00
220 REM                         mcs 1000/3 (koelliker) PaDaE
230 REM                         spur 1  alpha
240 REM                         spur 2  numeric
250 REM                         spur 3  alpha
260 REM   Pinbelegung 2/3 7     datenformat: 2400/8/n/1
270 REM
280 REM ***********************************************************************
290 INBUFF$=""
300 REM *** START MAINLOOP
310 REM **********************************************************************
320 GOSUB 6130
330 CLS:MASK=1:GOSUB 520
340 KEY 1,"ENDE":KEY 2,"PDE"
350 KEY ON
360 ON KEY(1) GOSUB 3930
370 KEY (1) ON
380 ON KEY(2) GOSUB 4030
390 KEY (2) ON
400 IF LOC(1) > 0 THEN GOSUB 6050:LOCATE 9,71:PRINT INBUFF$;
410 GOTO 410
420 REM **********************************************************************
430 IF LOC(1) > 0 THEN GOSUB 6050:LOCATE 9,71:PRINT INBUFF$;
440 CLS:MASK=1:GOSUB 520
450 KEY (3) OFF
460 KEY (4) OFF
470 KEY (5) OFF
480 KEY (6) OFF
490 KEY (8) OFF
500 KEY (9) OFF
510 GOTO 340
520 REM **********************************************************************
530 REM *** SET SCREEN 1
540 REM **********************************************************************
550 IF MASK=1 THEN GOTO 590
560 IF MASK=2 THEN GOTO 890
570 IF MASK=3 THEN GOTO 720
580 RETURN
590 CLS
600 COLOR 7,0
610 LOCATE 2,1
620 PRINT STRING$(80,205)
630 COLOR 26:PRINT TAB(2);"                                   MCS - 1000  (P)ATIENTEN (D)ATEN (E)RFASSUNG";
640 PRINT TAB(2);"OBERDIESSBACH                      (C) 1988 by KOELLIKER AG SPITALORGANISATION"
650 COLOR 7,0:PRINT STRING$(80,205)
660 LOCATE 10,21:PRINT"F1 - E N D E"
670 LOCATE 12,21:PRINT"F2 - Start PDE"
680 LOCATE 21,1:PRINT TAB(21);"Welches Programm wollen Sie: ? ";
690 LOCATE 20,1:PRINT STRING$(80,205)
700 LOCATE 22,1:PRINT STRING$(80,205)
710 RETURN
720 CLS
730 COLOR 7,0
740 LOCATE 2,1
750 PRINT STRING$(80,205)
760 PRINT TAB(2);"                                   MCS - 1000  (P)ATIENTEN (D)ATEN (E)RFASSUNG";
770 PRINT TAB(2);"OBERDIESSBACH                      (C) 1988 by KOELLIKER AG SPITALORGANISATION"
780 PRINT STRING$(80,205)
790 LOCATE 8,21:PRINT"F3 - KARTE EINLESEN"
800 LOCATE 16,21:PRINT"F4 - KARTE AUSWERFEN"
810 LOCATE 14,21:PRINT"F5 - ETIKETTEN DRUCKEN"
820 LOCATE 10,21:PRINT"F6 - PATIENTENAUFNAHME"
830 LOCATE 12,21:PRINT"F7 - KARTE KOPIEREN"
840 LOCATE 18,21:PRINT"F10 - PROGRAMM ENDE "
850 LOCATE 21,1:PRINT TAB(21);"Welches Programm wollen Sie: ? ";
860 LOCATE 20,1:PRINT STRING$(80,205)
870 LOCATE 22,1:PRINT STRING$(80,205)
880 RETURN
890 CLS
900 REM LOCATE 2,1
910 REM PRINT "KOELLIKER AG, ZUERICH       OBERDIESSBACH       (P)ATIENTEN (D)ATEN (E)RFASSUNG";
920 REM PRINT STRING$(80,205)
930 REM LOCATE 4,1:PRINT" ":COLOR 7,0
940 REM LOCATE 4,1:PRINT"P D E  HAUPTPROGRAMM:"
950 LOCATE 9,58:PRINT"STATUS BOX:           ";
960 REM LOCATE 8,1
970 REM PRINT STRING$(80,205)
980 LOCATE 20,58:PRINT "DIALOG BOX:          ";
990 LOCATE 21,58:PRINT "IHRE AUSWAHL BITTE ! ";
1000 REM LOCATE 23,58:PRINT "STATUS BOX:          ";
1010 REM LOCATE 20,1:PRINT STRING$(80,205)
1020 REM LOCATE 22,1:PRINT STRING$(80,205)
1030 RETURN
1040 RETURN
1050 REM **********************************************************************
1060 REM *** GET KEY INPUT
1070 REM **********************************************************************
1080 COLOR 7,0:LOCATE Y,X:PRINT "_";:LOCATE Y,X
1090 KEYBUFF$="":IN$=""
1100 REM TYPE ABFRAGE EINBAUERN
1110 P=X
1120 IN$=INPUT$(1)
1130 IF ASC(IN$)>95 AND ASC(IN$)<123 THEN IN$=CHR$(ASC(IN$)-32)
1140 IF IN$=CHR$(8) AND LEN(KEYBUFF$) = 0 THEN PRINT CHR$(7);:GOTO 1120
1150 IF IN$=CHR$(8)THEN P=P-1:LOCATE Y,P:PRINT"_";:COLOR 0,7:PRINT " ";:COLOR 7,0:LOCATE Y,P:KEYBUFF$=MID$(KEYBUFF$,1,(LEN(KEYBUFF$)-1)):GOTO 1120
1160 IF IN$=""THEN GOTO 1120
1170 IF IN$=CHR$(13) THEN COLOR 7,0:PRINT " ";:GOTO 1230
1180 IF IN$=CHR$(27) THEN COLOR 7,0:PRINT " ";:GOTO 1230
1190 IF LEN(KEYBUFF$) = L THEN PRINT CHR$(7);:GOTO 1120
1200 P=P+1:PRINT IN$+"_";:LOCATE Y,P
1210 KEYBUFF$=KEYBUFF$+IN$
1220 GOTO 1120
1230 IF LEN(KEYBUFF$) < L AND TYPE$="NUMERIC" THEN KEYBUFF$="0"+KEYBUFF$:GOTO 1230
1240 IF LEN(KEYBUFF$) < L THEN KEYBUFF$=KEYBUFF$+" ":GOTO 1240
1250 COLOR 0,7:LOCATE Y,X:PRINT KEYBUFF$;:COLOR 7,0
1260 RETURN
1270 REM numeric input
1280 IN$ = INKEY$
1290 PRINT IN$
1300 TYPE$=""
1310 RETURN
1320 REM **********************************************************************
1330 REM *** DISPLAY BUFFER DATA
1340 REM **********************************************************************
1350 GOSUB 4700:REM GET STATUS
1360 PATNAME$=MID$(BUFFER1$,1,25)
1370 VORNAME$=MID$(BUFFER1$,26,15)
1380 STRASSE$=MID$(BUFFER1$,41,25)
1390 GESCHL$=MID$(BUFFER1$,66,1)
1400 GARANT$=MID$(BUFFER1$,67,4)
1410 KONF$=MID$(BUFFER1$,71,1)
1420 PATNUM$=MID$(BUFFER2$,1,10)
1430 GEBDAT$=MID$(BUFFER2$,11,8)
1440 EINTRITTDAT$=MID$(BUFFER2$,19,8)
1450 KLASSE$=MID$(BUFFER2$,27,1)
1460 ORT$=MID$(BUFFER3$,1,25)
1470 TEL$=MID$(BUFFER3$,26,15)
1480 ARZT$=MID$(BUFFER3$,41,25)
1485 RETURN
1490 COLOR 0,7:LOCATE 1,17:PRINT PATNUM$
1500 COLOR 0,7:LOCATE 3,17:PRINT PATNAME$
1510 COLOR 0,7:LOCATE 5,17:PRINT VORNAME$
1520 COLOR 0,7:LOCATE 7,17:PRINT STRASSE$
1530 COLOR 0,7:LOCATE 9,17:PRINT ORT$
1550 COLOR 0,7:LOCATE 11,17:PRINT TEL$
1560 COLOR 0,7:LOCATE 13,17:PRINT GEBDAT$
1570 COLOR 0,7:LOCATE 15,17:PRINT NAT$
1580 COLOR 0,7:LOCATE 17,17:PRINT GESCHL$
1590 COLOR 0,7:LOCATE 19,17:PRINT KONF$
1600 COLOR 0,7:LOCATE 21,17:PRINT ZIVILST$
1610 COLOR 0,7:LOCATE 23,17:PRINT HEIMO$
1620 COLOR 7,0
1630 RETURN
1650 COLOR 0,7:LOCATE 1,17:PRINT BERUF$
1660 COLOR 0,7:LOCATE 3,17:PRINT STEUER$
1670 COLOR 0,7:LOCATE 5,17:PRINT ARBEITGEB$
1680 COLOR 0,7:LOCATE 7,17:PRINT B$
1690 COLOR 0,7:LOCATE 9,17:PRINT ATEL$
1700 COLOR 0,7:LOCATE 11,17:PRINT ZUSTELL$
1710 COLOR 0,7:LOCATE 13,17:PRINT Z$
1720 COLOR 0,7:LOCATE 15,17:PRINT ZTEL$
1730 COLOR 0,7:LOCATE 17,17:PRINT ANGEH$
1740 COLOR 0,7:LOCATE 19,17:PRINT H$
1750 COLOR 0,7:LOCATE 21,17:PRINT HTEL$
1760 COLOR 7,0
1770 RETURN
1780 COLOR 0,7:LOCATE 1,17:PRINT ABT$
1790 COLOR 0,7:LOCATE 3,17:PRINT STAT$
1800 COLOR 0,7:LOCATE 5,17:PRINT ZI$
1810 COLOR 0,7:LOCATE 7,17:PRINT TINTERN$
1820 COLOR 0,7:LOCATE 9,17:PRINT EINTRITTDAT$
1830 COLOR 0,7:LOCATE 11,17:PRINT ZEIT$
1840 COLOR 0,7:LOCATE 13,17:PRINT GRUND$
1850 COLOR 0,7:LOCATE 15,17:PRINT GARANT$
1860 COLOR 0,7:LOCATE 17,17:PRINT KLASSE$
1870 COLOR 0,7:LOCATE 19,17:PRINT FRDAT$
1880 COLOR 7,0
1890 RETURN
1900 COLOR 0,7:LOCATE 1,17:PRINT V$
1910 COLOR 0,7:LOCATE 3,17:PRINT V2$
1920 COLOR 0,7:LOCATE 5,17:PRINT V3$
1930 COLOR 0,7:LOCATE 7,17:PRINT V4$
1940 COLOR 0,7:LOCATE 9,17:PRINT W$
1950 COLOR 0,7:LOCATE 11,17:PRINT W2$
1960 COLOR 0,7:LOCATE 13,17:PRINT W3$
1970 COLOR 0,7:LOCATE 15,17:PRINT W4$
1980 COLOR 0,7:LOCATE 17,17:PRINT X$
1990 COLOR 0,7:LOCATE 19,17:PRINT X2$
2000 COLOR 0,7:LOCATE 21,17:PRINT X3$
2010 COLOR 0,7:LOCATE 23,17:PRINT X4$
2015 COLOR 7,0
2020 RETURN
2030 COLOR 0,7:LOCATE 1,17:PRINT ARZT$
2040 COLOR 0,7:LOCATE 3,17:PRINT S2$
2050 COLOR 0,7:LOCATE 5,17:PRINT S3$
2060 COLOR 0,7:LOCATE 7,17:PRINT T$
2070 COLOR 0,7:LOCATE 9,17:PRINT T2$
2080 COLOR 0,7:LOCATE 11,17:PRINT T3$
2090 COLOR 0,7:LOCATE 13,17:PRINT U$
2100 COLOR 0,7:LOCATE 15,17:PRINT U2$
2110 COLOR 0,7:LOCATE 17,17:PRINT U3$
2120 COLOR 7,0
2130 RETURN
2140 REM **********************************************************************
2150 REM *** WRITE BUFFER TO MCS
2160 REM **********************************************************************
2170 COLOR 0,7
2180 PRINT #1,ESC$;WRITE1$;BUFFER1$;CR$;
2190 LINE INPUT #1,INBUFF$
2200 PRINT #1,ESC$;WRITE2$;BUFFER2$;CR$;
2210 LINE INPUT #1,INBUFF$
2220 PRINT #1,ESC$;WRITE3$;BUFFER3$;CR$;
2230 LINE INPUT #1,INBUFF$
2240 PRINT #1,ESC$;WRITEON$;CR$
2250 LINE INPUT #1,INBUFF$:COLOR 0,7:LOCATE 9,79:PRINT INBUFF$;
2260 COLOR 7,0
2270 LINE INPUT #1,INBUFF$:COLOR 0,7:LOCATE 9,79:PRINT INBUFF$;
2280 RETURN
2290 REM **********************************************************************
2300 REM *** EDIT DATA BUFFER
2310 REM **********************************************************************
2320 MASK=2:GOSUB 520:GOSUB 5240
2330 COLOR 7,0
2340 REM LOCATE 23,58:PRINT "STATUS BOX:         ";
2350 LOCATE 20,58:PRINT "DIALOG BOX:         ";
2360 LOCATE 21,58:PRINT "DATENEINGABE ANGEW.!";
2370 REM ----------------------------------------------------------------------
2380 X=17:Y=1:L=5:TYPE$="NUMERIC":GOSUB 1050:PATNUM$=KEYBUFF$+"."
2381 IF IN$=CHR$(27)THEN RETURN:PATNUM$=KEYBUFF$+"."
2382 X=23:Y=1:L=2:TYPE$="NUMERIC":GOSUB 1050:PATNUM$=PATNUM$+KEYBUFF$+"."
2383 IF IN$=CHR$(27)THEN RETURN:PATNUM$=PATNUM$+KEYBUFF$+"."
2384 X=26:Y=1:L=1:TYPE$="NUMERIC":GOSUB 1050:PATNUM$=PATNUM$+KEYBUFF$:GOSUB 8140
2390 IF IN$=CHR$(27)THEN RETURN:PATNUM$=PATNUM$+KEYBUFF$
2400 X=17:Y=3:L=25:TYPE$="":GOSUB 1050:PATNAME$=KEYBUFF$
2410 IF IN$=CHR$(27)THEN RETURN:PATNAME$=KEYBUFF$
2420 X=17:Y=5:L=15:TYPE$="":GOSUB 1050:VORNAME$=KEYBUFF$
2430 IF IN$=CHR$(27)THEN RETURN:VORNAME$=KEYBUFF$
2440 X=17:Y=7:L=25:TYPE$="":GOSUB 1050:STRASSE$=KEYBUFF$
2450 IF IN$=CHR$(27)THEN RETURN:STRASSE$=KEYBUFF$
2460 X=17:Y=9:L=25:TYPE$="":GOSUB 1050:ORT$=KEYBUFF$
2470 IF IN$=CHR$(27)THEN RETURN:ORT$=KEYBUFF$
2480 X=17:Y=11:L=15:TYPE$="":GOSUB 1050:TEL$=KEYBUFF$
2490 IF IN$=CHR$(27)THEN RETURN:TEL$=KEYBUFF$
2500 X=17:Y=13:L=2:TYPE$="NUMERIC":GOSUB 1050:GEBDAT$=KEYBUFF$+"."
2510 IF IN$=CHR$(27)THEN RETURN:GEBDAT$=KEYBUFF$+"."
2520 X=20:Y=13:L=2:TYPE$="NUMERIC":GOSUB 1050:GEBDAT$=GEBDAT$+KEYBUFF$+"."
2530 IF IN$=CHR$(27)THEN RETURN:GEBDAT$=GEBDAT$+KEYBUFF$+"."
2540 X=23:Y=13:L=2:TYPE$="NUMERIC":GOSUB 1050:GEBDAT$=GEBDAT$+KEYBUFF$
2550 IF IN$=CHR$(27)THEN RETURN:GEBDAT$=GEBDAT$+KEYBUFF$
2560 X=17:Y=15:L=1:TYPE$="":GOSUB 1050:GESCHL$=KEYBUFF$
2570 IF IN$=CHR$(27)THEN RETURN:GESCHL$=KEYBUFF$
2571 X=17:Y=17:L=30:TYPE$="":GOSUB 1050:NAT$=KEYBUFF$
2572 IF IN$=CHR$(27)THEN RETURN:NAT$=KEYBUFF$
2573 X=17:Y=19:L=1:TYPE$="":GOSUB 1050:KONF$=KEYBUFF$
2574 IF IN$=CHR$(27)THEN RETURN:KONF$=KEYBUFF$
2575 X=17:Y=21:L=1:TYPE$="":GOSUB 1050:ZIVILST$=KEYBUFF$
2576 IF IN$=CHR$(27)THEN RETURN:ZIVILST$=KEYBUFF$
2577 X=17:Y=23:L=25:TYPE$="":GOSUB 1050:HEIMO$=KEYBUFF$
2578 IF IN$=CHR$(27)THEN RETURN:HEIMO$=KEYBUFF$
2580 IF IN$=CHR$(13)THEN GOSUB 7940
2590 CLS:GOSUB 5410
2620 X=17:Y=1:L=25:TYPE$="":GOSUB 1050:BERUF$=KEYBUFF$
2630 IF IN$=CHR$(27)THEN RETURN:BERUF$=KEYBUFF$
2640 X=17:Y=3:L=3:TYPE$="":GOSUB 1050:STEUER$=KEYBUFF$
2650 IF IN$=CHR$(27)THEN RETURN:STEUER$=KEYBUFF$
2660 X=17:Y=5:L=25:TYPE$="":GOSUB 1050:ARBEITGEB$=KEYBUFF$
2670 IF IN$=CHR$(27)THEN RETURN:ARBEITGEB$=KEYBUFF$
2680 X=17:Y=7:L=25:TYPE$="":GOSUB 1050:B$=KEYBUFF$
2690 IF IN$=CHR$(27)THEN RETURN:B$=KEYBUFF$
2700 X=17:Y=9:L=25:TYPE$="":GOSUB 1050:ATEL$=KEYBUFF$
2710 IF IN$=CHR$(27)THEN RETURN:ATEL$=KEYBUFF$
2720 X=17:Y=11:L=25:TYPE$="":GOSUB 1050:ZUSTELL$=KEYBUFF$
2730 IF IN$=CHR$(27)THEN RETURN:ZUSTELL$=KEYBUFF$
2740 X=17:Y=13:L=25:TYPE$="":GOSUB 1050:Z$=KEYBUFF$
2750 IF IN$=CHR$(27)THEN RETURN:Z$=KEYBUFF$
2760 X=17:Y=15:L=25:TYPE$="":GOSUB 1050:ZTEL$=KEYBUFF$
2770 IF IN$=CHR$(27)THEN RETURN:ZTEL$=KEYBUFF$
2780 X=17:Y=17:L=25:TYPE$="":GOSUB 1050:ANGEH$=KEYBUFF$
2790 IF IN$=CHR$(27)THEN RETURN:ANGEH$=KEYBUFF$
2800 X=17:Y=19:L=25:TYPE$="":GOSUB 1050:H$=KEYBUFF$
2810 IF IN$=CHR$(27)THEN RETURN:H$=KEYBUFF$
2820 X=17:Y=21:L=25:TYPE$="":GOSUB 1050:HTEL$=KEYBUFF$
2830 IF IN$=CHR$(27)THEN RETURN:HTEL$=KEYBUFF$
2920 IF IN$=CHR$(13)THEN GOSUB 8020
2930 CLS:GOSUB 5530
2940 X=17:Y=1:L=10:TYPE$="":GOSUB 1050:ABT$=KEYBUFF$
2950 IF IN$=CHR$(27)THEN RETURN:ABT$=KEYBUFF$
2960 X=17:Y=3:L=3:TYPE$="":GOSUB 1050:STAT$=KEYBUFF$
2970 IF IN$=CHR$(27)THEN RETURN:STAT$=KEYBUFF$
2980 X=17:Y=5:L=3:TYPE$="":GOSUB 1050:ZI$=KEYBUFF$
2990 IF IN$=CHR$(27)THEN RETURN:ZI$=KEYBUFF$
3000 X=17:Y=7:L=3:TYPE$="":GOSUB 1050:TINTERN$=KEYBUFF$
3010 IF IN$=CHR$(27)THEN RETURN:TINTERN$=KEYBUFF$
3020 X=17:Y=9:L=2:TYPE$="NUMERIC":GOSUB 1050:EINTRITTDAT$=KEYBUFF$+"."
3030 IF IN$=CHR$(27)THEN RETURN:EINTRITTDAT$=KEYBUFF$+"."
3032 X=20:Y=9:L=2:TYPE$="NUMERIC":GOSUB 1050:EINTRITTDAT$=EINTRITTDAT$+KEYBUFF$+"."
3033 IF IN$=CHR$(27)THEN RETURN:EINTRITTDAT$=EINTRITTDAT$+KEYBUFF$+"."
3034 X=23:Y=9:L=2:TYPE$="NUMERIC":GOSUB 1050:EINTRITTDAT$=EINTRITTDAT$+KEYBUFF$
3035 IF IN$=CHR$(27)THEN RETURN:EINTRITTDAT$=EINTRITTDAT$+KEYBUFF$
3040 X=17:Y=11:L=2:TYPE$="":GOSUB 1050:ZEIT$=KEYBUFF$+"."
3050 IF IN$=CHR$(27)THEN RETURN:ZEIT$=KEYBUFF$+"."
3054 X=20:Y=11:L=2:TYPE$="":GOSUB 1050:ZEIT$=ZEIT$+KEYBUFF$
3056 IF IN$=CHR$(27)THEN RETURN:ZEIT$=ZEIT$+KEYBUFF$
3060 X=17:Y=13:L=20:TYPE$="":GOSUB 1050:GRUND$=KEYBUFF$
3070 IF IN$=CHR$(27)THEN RETURN:GRUND$=KEYBUFF$
3080 X=17:Y=15:L=4:TYPE$="":GOSUB 1050:GARANT$=KEYBUFF$
3090 IF IN$=CHR$(27)THEN RETURN:GARANT$=KEYBUFF$
3100 X=17:Y=17:L=1:TYPE$="NUMERIC":GOSUB 1050:KLASSE$=KEYBUFF$
3110 IF IN$=CHR$(27)THEN RETURN:KLASSE$=KEYBUFF$
3120 X=17:Y=19:L=4:TYPE$="":GOSUB 1050:FRDAT$=KEYBUFF$+"."
3130 IF IN$=CHR$(27)THEN RETURN:FRDAT$=KEYBUFF$+"."
3134 X=22:Y=19:L=2:TYPE$="":GOSUB 1050:FRDAT$=FRDAT$+KEYBUFF$
3135 IF IN$=CHR$(27)THEN RETURN:FRDAT$=FRDAT$+KEYBUFF$
3140 IF IN$=CHR$(13)THEN GOSUB 7830
3141 CLS:GOSUB 5630
3142 X=17:Y=1:L=30:TYPE$="":GOSUB 1050:V$=KEYBUFF$
3143 IF IN$=CHR$(27)THEN RETURN:V$=KEYBUFF$
3144 X=17:Y=3:L=30:TYPE$="":GOSUB 1050:V2$=KEYBUFF$
3145 IF IN$=CHR$(27)THEN RETURN:V2$=KEYBUFF$
3146 X=17:Y=5:L=30:TYPE$="":GOSUB 1050:V3$=KEYBUFF$
3147 IF IN$=CHR$(27)THEN RETURN:V3$=KEYBUFF$
3148 X=17:Y=7:L=30:TYPE$="":GOSUB 1050:V4$=KEYBUFF$
3149 IF IN$=CHR$(27)THEN RETURN:V4$=KEYBUFF$
3150 X=17:Y=9:L=30:TYPE$="":GOSUB 1050:W$=KEYBUFF$
3151 IF IN$=CHR$(27)THEN RETURN:W$=KEYBUFF$
3152 X=17:Y=11:L=30:TYPE$="":GOSUB 1050:W2$=KEYBUFF$
3153 IF IN$=CHR$(27)THEN RETURN:W2$=KEYBUFF$
3154 X=17:Y=13:L=30:TYPE$="":GOSUB 1050:W3$=KEYBUFF$
3155 IF IN$=CHR$(27)THEN RETURN:W3$=KEYBUFF$
3156 X=17:Y=15:L=30:TYPE$="":GOSUB 1050:W4$=KEYBUFF$
3157 IF IN$=CHR$(27)THEN RETURN:W4$=KEYBUFF$
3158 X=17:Y=17:L=30:TYPE$="":GOSUB 1050:X$=KEYBUFF$
3159 IF IN$=CHR$(27)THEN RETURN:X$=KEYBUFF$
3160 X=17:Y=19:L=30:TYPE$="":GOSUB 1050:X2$=KEYBUFF$
3161 IF IN$=CHR$(27)THEN RETURN:X2$=KEYBUFF$
3162 X=17:Y=21:L=30:TYPE$="":GOSUB 1050:X3$=KEYBUFF$
3163 IF IN$=CHR$(27)THEN RETURN:X3$=KEYBUFF$
3164 X=17:Y=23:L=30:TYPE$="":GOSUB 1050:X4$=KEYBUFF$
3165 IF IN$=CHR$(27)THEN RETURN:X4$=KEYBUFF$
3166 IF IN$=CHR$(13)THEN GOSUB 9000
3167 CLS:GOSUB 5760
3168 X=17:Y=1:L=25:TYPE$="":GOSUB 1050:ARZT$=KEYBUFF$
3169 IF IN$=CHR$(27)THEN RETURN:ARZT$=KEYBUFF$
3170 X=17:Y=3:L=30:TYPE$="":GOSUB 1050:S2$=KEYBUFF$
3171 IF IN$=CHR$(27)THEN RETURN:S2$=KEYBUFF$
3172 X=17:Y=5:L=30:TYPE$="":GOSUB 1050:S3$=KEYBUFF$
3173 IF IN$=CHR$(27)THEN RETURN:S3$=KEYBUFF$
3174 X=17:Y=7:L=30:TYPE$="":GOSUB 1050:T$=KEYBUFF$
3175 IF IN$=CHR$(27)THEN RETURN:T$=KEYBUFF$
3176 X=17:Y=9:L=30:TYPE$="":GOSUB 1050:T2$=KEYBUFF$
3177 IF IN$=CHR$(27)THEN RETURN:T2$=KEYBUFF$
3178 X=17:Y=11:L=30:TYPE$="":GOSUB 1050:T3$=KEYBUFF$
3179 IF IN$=CHR$(27)THEN RETURN:T3$=KEYBUFF$
3180 X=17:Y=13:L=30:TYPE$="":GOSUB 1050:U$=KEYBUFF$
3181 IF IN$=CHR$(27)THEN RETURN:U$=KEYBUFF$
3182 X=17:Y=15:L=30:TYPE$="":GOSUB 1050:U2$=KEYBUFF$
3183 IF IN$=CHR$(27)THEN RETURN:U2$=KEYBUFF$
3184 X=17:Y=17:L=30:TYPE$="":GOSUB 1050:U3$=KEYBUFF$
3185 IF IN$=CHR$(27)THEN RETURN:U3$=KEYBUFF$
3187 IF IN$=CHR$(13)THEN GOSUB 9300
3188 CLS
3190 BUFFER1$=PATNAME$+VORNAME$+STRASSE$+GESCHL$+GARANT$+KONF$
3200 BUFFER2$=MID$(PATNUM$,1,5)+"D"+MID$(PATNUM$,7,2)+"D"+MID$(PATNUM$,10,1)
3202 BUFFER2$=BUFFER2$+MID$(GEBDAT$,1,2)+"D"+MID$(GEBDAT$,4,2)+"D"+MID$(GEBDAT$,7,2)
3204 BUFFER2$=BUFFER2$+MID$(EINTRITTDAT$,1,2)+"D"+MID$(EINTRITTDAT$,4,2)+"D"+MID$(EINTRITTDAT$,7,2)
3206 BUFFER2$=BUFFER2$+KLASSE$
3210 BUFFER3$=ORT$+TEL$+ARZT$
3220 IF LEN(BUFFER2$)<37 THEN BUFFER2$=BUFFER2$+"0":GOTO 3220
3230 LOCATE 20,58:PRINT "DIALOG BOX:           ";
3240 LOCATE 21,58:PRINT "šBERTRAGE DIE DATEN ! ";
3250 GOSUB 2140
3260 REM LOCATE 23,58:PRINT "STATUS BOX:           ";
3270 LOCATE 21,58:PRINT "BITTE DIE MAGNETKARTE!";
3280 GOSUB 6050
3290 GOSUB 4700
3300 LOCATE 21,58:PRINT "DIE KARTE IST OK !!   ";
3305 PRINT #1,ESC$;RETCARD$;CR$;:LINE INPUT #1,INBUFF$:LOCATE 9,79:PRINT INBUFF$;
3310 ON KEY (10) GOSUB 3405
3320 KEY (10) ON
3330 ON KEY (9) GOSUB 3400
3340 KEY (9) ON
3350 ON KEY (5) GOSUB 7000
3360 KEY (5) ON
3370 ON KEY (8) GOSUB 7140
3380 KEY (8) ON
3390 GOTO 3310
3400 PRINT #1,ESC$;RETCARD$;CR$:LINE INPUT #1,INBUFF$:LOCATE 9,79:PRINT INBUFF$;:GOSUB 6050:RETURN 2330
3404 REM IN$=INPUT$(1)
3405 LOCATE 20,58:PRINT "DIALOG BOX:           ";
3406 LOCATE 21,58:PRINT "SIND SIE SICHER? J/N ";:LINE INPUT SICHER$
3407 IF SICHER$="N" OR SICHER$="n" THEN RETURN 3300
3408 IF SICHER$="J" OR SICHER$="j" THEN GOTO 3410
3410 PRINT #1,ESC$;RETCARD$;CR$:LINE INPUT #1,INBUFF$:LOCATE 9,79:PRINT INBUFF$;:GOSUB 6050:RETURN 4150
3420 REM **********************************************************************
3430 REM *** PRINT ETIKETTEN
3440 REM **********************************************************************
3450 COLOR 0,7:LOCATE 20,58:PRINT "DIALOG BOX:          ";
3460 COLOR 0,7:LOCATE 21,58:PRINT "AUSDRUCK LŽUFT !     ";
3470 PRINT #1,ESC$;PRINTERON$;CR$;:LINE INPUT #1,INBUFF$
3480 PRINT #1,CR$;CHR$(10);
3490 PRINT #1," ";
3500 PRINT #1,PATNAME$;"";PATNUM$;
3510 PRINT #1,CR$;CHR$(10);:GOSUB 6740:GOSUB 6740
3520 PRINT #1," ";
3530 PRINT #1,VORNAME$;"    ";KLASSE$;"    ";GEBDAT$;"/";GESCHL$;
3540 PRINT #1,CR$;CHR$(10);:GOSUB 6740:GOSUB 6740
3550 PRINT #1," ";
3560 PRINT #1,ORT$;"     ";GARANT$;
3570 PRINT #1,CR$;CHR$(10);:GOSUB 6740:GOSUB 6740
3580 PRINT #1," ";
3590 PRINT #1,ARZT$;" ";EINTRITTDAT$;
3600 PRINT #1,CR$;CHR$(10);:GOSUB 6740:GOSUB 6740
3610 PRINT #1," ";
3620 REM PRINT #1,CR$;CHR$(13);
3630 PRINT #1,CR$;CHR$(24);
3640 PRINT #1,ESC$;PRINTEROFF$;CR$;:LINE INPUT #1,INBUFF$
3650 LOCATE 9,79:PRINT INBUFF$;
3660 GOSUB 4700
3670 COLOR 7,0:LOCATE 21,58:PRINT "AUSDRUCK FERTIG !!   ";
3680 RETURN
3690 REM **********************************************************************
3700 REM *** COPY SCREEN (BUFFER) TO MCS
3710 REM **********************************************************************
3720 MASK = 2:GOSUB 520
3730 GOSUB 1320:GOSUB 1490:GOSUB 1650:GOSUB 1780:GOSUB 1900:GOSUB 2030
3740 LOCATE 20,58:PRINT "DIALOG BOX:          ";
3750 LOCATE 21,58:PRINT "COPY PROGRAM !       ";
3760 GOSUB 2140
3770 COLOR 7,0
3780 LOCATE 21,58:PRINT "KARTE EINLEGEN! OK J/N";
3790 IN$= INPUT$(1)
3800 IF IN$="J" OR IN$="j" THEN GOTO 3830
3810 IF IN$="N" OR IN$="n" THEN MASK=1:COLOR 7,0:RETURN 4150
3820 GOTO 3790
3830 PRINT#1,ESC$;RETCARD$;CR$;:LINE INPUT #1,INBUFF$:LOCATE 9,79:PRINT INBUFF$;
3840 LOCATE 21,58:PRINT "OK, KARTE KOPIERT !   ";
3850 GOSUB 6050
3860 ON KEY (10) GOSUB 3920
3870 KEY (10) ON
3880 ON KEY (9) GOSUB 3910
3890 KEY (9) ON
3900 GOTO 3900
3910 RETURN 3690
3920 RETURN 4150
3930 REM *********************************************************************
3940 REM *** Return to System
3950 REM *********************************************************************
3960 PRINT #1,ESC$;"H";CR$;:GOSUB 6050:LOCATE 9,79:PRINT INBUFF$;
3970 PRINT #1,ESC$;"R";CR$;:GOSUB 6050:LOCATE 9,79:PRINT INBUFF$;
3980 PRINT #1,ESC$;"F";CR$;:GOSUB 6050:LOCATE 9,79:PRINT INBUFF$;
3990 PRINT #1,ESC$;"R";CR$;:GOSUB 6050:LOCATE 9,79:PRINT INBUFF$;
4000 CLS
4010 GOSUB 6180 : REM CLOSE COM
4020 SYSTEM
4030 REM *** PDE HAUPTPROGRAMM
4040 REM *** PDE HAUPTPROGRAMM
4050 REM *********************************************************************
4060 GOSUB 6320:GOSUB 4700
4070 KEY 3,"READ"
4080 KEY 4,"WRITE"
4090 KEY 5,"PRINT"
4100 KEY 6,"EDIT"
4110 KEY 7,"COPY"
4120 KEY 8,"SDRUCK"
4130 KEY 9,"REPEAT"
4140 KEY 10,"RETURN"
4150 MASK=3:GOSUB 520:REM INIT SCREEN
4160 ON KEY (3) GOSUB 4300
4170 KEY (3) ON
4180 ON KEY (7) GOSUB 3690
4190 KEY (7) ON
4200 ON KEY (6) GOSUB 2290
4210 KEY (6) ON
4220 ON KEY (4) GOSUB 6650
4230 KEY (4) ON
4240 KEY (5) OFF
4250 KEY (8) OFF
4260 ON KEY(10) GOSUB 4290
4270 KEY (10) ON
4280 GOTO 4280
4290 RETURN 430
4300 REM *********************************************************************
4310 REM *** READ DATA FROM MCS and DISPLAY
4320 REM *********************************************************************
4330 MASK =2:GOSUB 520
4340 PRINT #1,ESC$;READON$;CR$:LINE INPUT #1,INBUFF$:LOCATE 9,79:PRINT INBUFF$;
4350 REM
4360 COLOR 0,7:LOCATE 20,58:PRINT "DIALOG BOX:           ";
4370 COLOR 0,7:LOCATE 21,58:PRINT "M.KARTE BITTE ! OK J/N";
4380 IN$= INPUT$(1)
4390 IF IN$="J" OR IN$="j" THEN GOTO 4420
4400 IF IN$="N" OR IN$="n" THEN MASK=1:COLOR 7,0:RETURN 4150
4410 GOTO 4380
4420 LINE INPUT #1,INBUFF$:LOCATE 9,79:PRINT INBUFF$;:COLOR 0,7
4430 PRINT#1,ESC$;RETCARD$;CR$;:LINE INPUT #1,INBUFF$:LOCATE 9,79:PRINT INBUFF$;
4440 LOCATE 20,58:PRINT "DIALOG BOX:         ";
4450 LOCATE 21,58:PRINT "LESE DIE DATEN EIN !";
4460 LINE INPUT #1,INBUFF$:LOCATE 9,79:PRINT INBUFF$;:COLOR 0,7
4470 PRINT #1,ESC$;READ1$;CR$;:LINE INPUT#1,INBUFF$:BUFFER1$=INBUFF$
4480 LOCATE 5,1:PRINT"T1: ";:PRINT BUFFER1$;
4490 PRINT #1,ESC$;READ2$;CR$;:LINE INPUT#1,INBUFF$:BUFFER2$=INBUFF$
4500 LOCATE 6,1:PRINT"T2: ";:PRINT BUFFER2$;
4510 PRINT #1,ESC$;READ3$;CR$;:LINE INPUT#1,INBUFF$:BUFFER3$=INBUFF$
4520 LOCATE 7,1:PRINT"T3: ";:PRINT BUFFER3$;
4530 COLOR 7,0
4540 LOCATE 23,58:PRINT "STATUS BOX:          ";
4550 LOCATE 20,58:PRINT "DIALOG BOX:           ";
4560 LOCATE 21,58:PRINT "IHRE AUSWAHL BITTE !  ";
4570 GOSUB 1320
4580 COLOR 7,0
4590 ON KEY (10) GOSUB 4690
4600 KEY (10) ON
4610 ON KEY (9) GOSUB 4680
4620 KEY (9) ON
4630 ON KEY (5) GOSUB 7000
4640 KEY (5) ON
4650 ON KEY (8) GOSUB 7140
4660 KEY (8) ON
4670 GOTO 4590
4680 RETURN 4340
4690 RETURN 4150
4700 REM *********************************************************************
4710 REM *** GET STATUS FROM MCS UNIT and DISPLAY in STATUS BOX
4720 REM *********************************************************************
4730 PRINT #1,ESC$;STATUS$;CR$;
4740 LINE INPUT #1,INBUFF$
4750 IF INBUFF$="?" THEN GOTO 4700
4760 IF INBUFF$="!" THEN GOTO 4700
4770 COLOR 0,7:LOCATE 9,71:PRINT INBUFF$;
4780 STAT1$=MID$(INBUFF$,1,1)
4790 STAT2$=MID$(INBUFF$,2,1)
4800 STAT3$=MID$(INBUFF$,3,1)
4810 STAT4$=MID$(INBUFF$,4,1)
4820 STAT5$=MID$(INBUFF$,5,1)
4830 STAT6$=MID$(INBUFF$,6,1)
4840 STAT7$=MID$(INBUFF$,7,1)
4850 STAT8$=MID$(INBUFF$,8,1)
4860 REM ---------------------------------------------------------------------
4870 REM PRINT EXTENDED STATUS
4880 REM ---------------------------------------------------------------------
4890 IF STAT1$ = "9" THEN LOCATE 24,13:PRINT "T1=OFF";
4900 IF STAT2$ = "9" THEN LOCATE 24,21:PRINT "T2=OFF";
4910 IF STAT3$ = "9" THEN LOCATE 24,29:PRINT "T3=OFF";
4920 IF STAT1$ = "0" THEN LOCATE 24,13:PRINT "T1=ON ";
4930 IF STAT2$ = "0" THEN LOCATE 24,21:PRINT "T2=ON ";
4940 IF STAT3$ = "0" THEN LOCATE 24,29:PRINT "T3=ON ";
4950 IF STAT1$ = "5" THEN LOCATE 24,13:PRINT "T1=ON ";
4960 IF STAT2$ = "5" THEN LOCATE 24,21:PRINT "T2=ON ";
4970 IF STAT3$ = "5" THEN LOCATE 24,29:PRINT "T3=ON ";
4980 IF STAT4$ = "0" THEN LOCATE 24,36:PRINT "READ ";
4990 IF STAT4$ = "1" THEN LOCATE 24,36:PRINT "WRITE";
5000 IF STAT1$ = "1" THEN LOCATE 24,13:PRINT "T1=ON ";:LOCATE 24,50:PRINT "CLOCK error T1";
5010 IF STAT2$ = "1" THEN LOCATE 24,21:PRINT "T2=ON ";:LOCATE 24,50:PRINT "CLOCK error T2";
5020 IF STAT3$ = "1" THEN LOCATE 24,29:PRINT "T3=ON ";:LOCATE 24,50:PRINT "CLOCK error T3";
5030 IF STAT1$ = "2" THEN LOCATE 24,13:PRINT "T1=ON ";:LOCATE 24,50:PRINT "PARITY ERROR T1";
5040 IF STAT2$ = "2" THEN LOCATE 24,21:PRINT "T2=ON ";:LOCATE 24,50:PRINT "PARITY error T2";
5050 IF STAT3$ = "2" THEN LOCATE 24,29:PRINT "T3=ON ";:LOCATE 24,50:PRINT "PARITY error T3";
5060 IF STAT1$ = "3" THEN LOCATE 24,13:PRINT "T1=ON ";:LOCATE 24,50:PRINT "LRC    ERROR T1";
5070 IF STAT2$ = "3" THEN LOCATE 24,21:PRINT "T2=ON ";:LOCATE 24,50:PRINT "LRC    error T2";
5080 IF STAT3$ = "3" THEN LOCATE 24,29:PRINT "T3=ON ";:LOCATE 24,50:PRINT "LRC    error T3";
5090 IF STAT1$ = "4" THEN LOCATE 24,13:PRINT "T1=ON ";:LOCATE 24,50:PRINT "ETX    ERROR T1";
5100 IF STAT2$ = "4" THEN LOCATE 24,21:PRINT "T2=ON ";:LOCATE 24,50:PRINT "ETX    error T2";
5110 IF STAT3$ = "4" THEN LOCATE 24,29:PRINT "T3=ON ";:LOCATE 24,50:PRINT "ETX    error T3";
5120 REM ---------------------------------------------------------------------
5130 REM SET ALL TRACKS  ACTIVE
5140 REM ---------------------------------------------------------------------
5150 IF STAT1$="9" THEN PRINT#1,ESC$;TRACK1$;CR$;:LINE INPUT #1,INBUFF$:LOCATE 9,79:PRINT INBUFF$;
5160 IF INBUFF$="?" THEN GOSUB 6740:GOTO 5150
5170 IF STAT2$="9" THEN PRINT#1,ESC$;TRACK2$;CR$;:LINE INPUT #1,INBUFF$:LOCATE 9,79:PRINT INBUFF$;
5180 IF INBUFF$="?" THEN GOSUB 6740:GOTO 5170
5190 IF STAT3$="9" THEN PRINT#1,ESC$;TRACK3$;CR$;:LINE INPUT #1,INBUFF$:LOCATE 9,79:PRINT INBUFF$;
5200 IF INBUFF$="?" THEN GOSUB 6740:GOTO 5190
5210 IF STAT1$="9" OR STAT2$="9" OR STAT3$="9" THEN GOTO 4700
5220 COLOR 7,0
5230 RETURN
5240 REM *********************************************************************
5250 REM *** SCREENMASK FOR EDIT DATA  NORMAL
5260 REM *********************************************************************
5270 LOCATE 1,1:PRINT"1 PATIENTEN-NR. ";:COLOR 0,7:PRINT"     .  . ";:COLOR 7,0
5280 LOCATE 3,1:PRINT"2 NAME          ";:COLOR 0,7:PRINT"                         ";:COLOR 7,0
5290 LOCATE 5,1:PRINT"3 VORNAME       ";:COLOR 0,7:PRINT"               ";:COLOR 7,0
5300 LOCATE 7,1:PRINT"4 STRASSE, NR.  ";:COLOR 0,7:PRINT"                         ";:COLOR 7,0
5310 LOCATE 9,1:PRINT"5 PLZ,ORT       ";:COLOR 0,7:PRINT"                         ";:COLOR 7,0
5320 LOCATE 11,1:PRINT"6 TEL.-PRIVAT   ";:COLOR 0,7:PRINT"               ";:COLOR 7,0
5330 LOCATE 13,1:PRINT"7  GEB.-DATUM   ";:COLOR 0,7:PRINT"  .  .  ";:COLOR 7,0
5340 LOCATE 15,1:PRINT"8  GESCHLECHT   ";:COLOR 0,7:PRINT" ";:COLOR 7,0
5350 LOCATE 17,1:PRINT"9  NATIONALITŽT ";:COLOR 0,7:PRINT"                              ";:COLOR 7,0
5360 LOCATE 19,1:PRINT"10 KONFESSION   ";:COLOR 0,7:PRINT" ";:COLOR 7,0
5370 LOCATE 21,1:PRINT"11 ZIVILSTAND   ";:COLOR 0,7:PRINT" ";:COLOR 7,0
5380 LOCATE 23,1:PRINT"12 HEIMATORT    ";:COLOR 0,7:PRINT"                        ";:COLOR 7,0
5390 RETURN
5410 LOCATE 1,1:PRINT"13 BERUF        ";:COLOR 0,7:PRINT"                         ";:COLOR 7,0
5420 LOCATE 3,1:PRINT"14 STEUER-CODE  ";:COLOR 0,7:PRINT"   ";:COLOR 7,0
5430 LOCATE 5,1:PRINT"15 ARBEITGEBER  ";:COLOR 0,7:PRINT"                         ";:COLOR 7,0
5440 LOCATE 7,1:PRINT"                ";:COLOR 0,7:PRINT"                         ";:COLOR 7,0
5450 LOCATE 9,1:PRINT"                ";:COLOR 0,7:PRINT"                         ";:COLOR 7,0
5460 LOCATE 11,1:PRINT"18 ZUSTELLADR.  ";:COLOR 0,7:PRINT"                         ";:COLOR 7,0
5470 LOCATE 13,1:PRINT"                ";:COLOR 0,7:PRINT"                         ";:COLOR 7,0
5480 LOCATE 15,1:PRINT"                ";:COLOR 0,7:PRINT"                         ";:COLOR 7,0
5490 LOCATE 17,1:PRINT"21 ANGEH™RIGE   ";:COLOR 0,7:PRINT"                         ";:COLOR 7,0
5500 LOCATE 19,1:PRINT"                ";:COLOR 0,7:PRINT"                         ";:COLOR 7,0
5510 LOCATE 21,1:PRINT"                ";:COLOR 0,7:PRINT"                         ";:COLOR 7,0
5520 RETURN
5530 LOCATE 1,1:PRINT"24 KLINIK-ABT.  ";:COLOR 0,7:PRINT"          ";:COLOR 7,0
5540 LOCATE 3,1:PRINT"25 STATION      ";:COLOR 0,7:PRINT"   ";:COLOR 7,0
5550 LOCATE 5,1:PRINT"26 ZIMMER-NR.   ";:COLOR 0,7:PRINT"   ";:COLOR 7,0
5560 LOCATE 7,1:PRINT"27 TEL.-NR. INT.";:COLOR 0,7:PRINT"   ";:COLOR 7,0
5570 LOCATE 9,1:PRINT"28 EINTR.-DAT.  ";:COLOR 0,7:PRINT"  .  .  ";:COLOR 7,0
5580 LOCATE 11,1:PRINT"29 EINTR.-ZEIT  ";:COLOR 0,7:PRINT"  .  ";:COLOR 7,0
5590 LOCATE 13,1:PRINT"30 EINTR.-GRUND ";:COLOR 0,7:PRINT"                    ";:COLOR 7,0
5600 LOCATE 15,1:PRINT"31 GARANT       ";:COLOR 0,7:PRINT"    ";:COLOR 7,0
5610 LOCATE 17,1:PRINT"32 KLASSE       ";:COLOR 0,7:PRINT" ";:COLOR 7,0
5620 LOCATE 19,1:PRINT"33 FRšH.AUFENTH.";:COLOR 0,7:PRINT"    .  ";:COLOR 7,0
5625 COLOR 7,0:RETURN
5630 LOCATE 1,1:PRINT"34 GARANT 1     ";:COLOR 0,7:PRINT"                              ";:COLOR 7,0
5640 LOCATE 3,1:PRINT"                ";:COLOR 0,7:PRINT"                              ";:COLOR 7,0
5650 LOCATE 5,1:PRINT"                ";:COLOR 0,7:PRINT"                              ";:COLOR 7,0
5660 LOCATE 7,1:PRINT"                ";:COLOR 0,7:PRINT"                              ";:COLOR 7,0
5670 LOCATE 9,1:PRINT"38 GARANT 2     ";:COLOR 0,7:PRINT"                              ";:COLOR 7,0
5680 LOCATE 11,1:PRINT"                ";:COLOR 0,7:PRINT"                              ";:COLOR 7,0
5690 LOCATE 13,1:PRINT"                ";:COLOR 0,7:PRINT"                              ";:COLOR 7,0
5700 LOCATE 15,1:PRINT"                ";:COLOR 0,7:PRINT"                              ";:COLOR 7,0
5710 LOCATE 17,1:PRINT"42 GARANT 3     ";:COLOR 0,7:PRINT"                              ";:COLOR 7,0
5720 LOCATE 19,1:PRINT"                ";:COLOR 0,7:PRINT"                              ";:COLOR 7,0
5730 LOCATE 21,1:PRINT"                ";:COLOR 0,7:PRINT"                              ";:COLOR 7,0
5740 LOCATE 23,1:PRINT"                ";:COLOR 0,7:PRINT"                              ";:COLOR 7,0
5750 COLOR 7,0:RETURN
5760 LOCATE 1,1:PRINT"46 EINW. ARZT   ";:COLOR 0,7:PRINT"                         ";:COLOR 7,0
5770 LOCATE 3,1:PRINT"                ";:COLOR 0,7:PRINT"                              ";:COLOR 7,0
5780 LOCATE 5,1:PRINT"                ";:COLOR 0,7:PRINT"                              ";:COLOR 7,0
5790 LOCATE 7,1:PRINT"49 HAUSARZT     ";:COLOR 0,7:PRINT"                              ";:COLOR 7,0
5800 LOCATE 9,1:PRINT"                ";:COLOR 0,7:PRINT"                              ";:COLOR 7,0
5810 LOCATE 11,1:PRINT"                ";:COLOR 0,7:PRINT"                              ";:COLOR 7,0
5820 LOCATE 13,1:PRINT"52 BEH. ARZT    ";:COLOR 0,7:PRINT"                              ";:COLOR 7,0
5830 LOCATE 15,1:PRINT"                ";:COLOR 0,7:PRINT"                              ";:COLOR 7,0
5840 LOCATE 17,1:PRINT"                ";:COLOR 0,7:PRINT"                              ";:COLOR 7,0
5850 COLOR 7,0:RETURN
5860 REM *********************************************************************
5870 REM *** SCREENMASK FOR EDIT DATA  INVERS
5880 REM *********************************************************************
5890 LOCATE 10,1:PRINT"1 NAME      ";:COLOR 0,7:PRINT"                         ";:COLOR 7,0
5900 LOCATE 12,1:PRINT"2 VORNAME   ";:COLOR 0,7:PRINT"              ";:COLOR 7,0
5910 LOCATE 14,1:PRINT"3 STRASSE   ";:COLOR 0,7:PRINT"                         ";:COLOR 7,0
5920 LOCATE 16,1:PRINT"4 PLZ, ORT  ";:COLOR 0,7:PRINT"                         ";:COLOR 7,0
5930 LOCATE 18,1:PRINT"5 GEB-DAT/G ";:COLOR 0,7:PRINT"        ";:COLOR 7,0
5940 LOCATE 20,1:PRINT"6 PAT.-NR   ";:COLOR 0,7:PRINT"       ";:COLOR 7,0
5950 LOCATE 10,39:PRINT"7  KLASSE       ";:COLOR 0,7:PRINT"    ";:COLOR 7,0
5960 LOCATE 12,39:PRINT"8  ABTEILUNG    ";:COLOR 0,7:PRINT"    ";:COLOR 7,0
5970 LOCATE 14,39:PRINT"9  EINTR.-DAT   ";:COLOR 0,7:PRINT"  .  .   ";:COLOR 7,0
5980 LOCATE 16,39:PRINT"10 GARANT       ";:COLOR 0,7:PRINT"    ";:COLOR 7,0
5990 LOCATE 18,39:PRINT"11 EINW. ARZT   ";:COLOR 0,7:PRINT"                         ";:COLOR 7,0
6000 LOCATE 20,39:PRINT"12 STATION      ";:COLOR 0,7:PRINT"    ";:COLOR 7,0
6010 COLOR 7,0
6020 RETURN
6030 REM *********************************************************************
6040 RETURN
6050 REM *********************************************************************
6060 REM *** GET INPUT BUFFER FROM COM
6070 REM *********************************************************************
6080 INBUFF$=""
6090 IF LOC(1) = 0 GOTO 6090
6100 LINE INPUT #1,INBUFF$
6110 IF LOC(1) > 0 THEN GOTO 6080
6120 RETURN
6130 REM *********************************************************************
6140 REM *** OPEN SERIAL COM1 2400/8/N/1
6150 REM *********************************************************************
6160 OPEN "com1:2400,N,8,,CS,DS,CD" AS #1
6170 RETURN
6180 REM *********************************************************************
6190 REM *** CLOSE SERIAL COM1 2400/8/N/1
6200 REM *********************************************************************
6210 CLOSE 1
6220 RETURN
6230 REM *********************************************************************
6240 REM *** DISPLAY MESSAGE
6250 REM *********************************************************************
6260 COLOR 0,7:LOCATE 22,16:PRINT MESSAGE$
6270 RETURN
6280 REM CLEAR MESSAGES BOX
6290 COLOR 0,7:LOCATE 23,16
6300 LOCATE 22,1:PRINT "DIALOG BOX:                                                                     ";
6310 RETURN
6320 REM *********************************************************************
6330 REM *** INIT MCS UNIT and SYSTEM VARIABLE and OPEN COM1 1200/8/N/1
6340 REM *********************************************************************
6350 CR$=CHR$(13)
6360 ESC$=CHR$(27)
6370 FS$=CHR$(28)
6380 BARCODE$="B"
6390 REMON$="E"
6400 REMOFF$="F"
6410 READ1$="G1"
6420 READ2$="G2"
6430 READ3$="G3"
6440 READ4$="G4"
6450 RETCARD$="H"
6460 WRITE1$="I1"
6470 WRITE2$="I2"
6480 WRITE3$="I3"
6490 PRINTERON$="J"
6500 PRINTEROFF$="K"
6510 PROTOKOLLON$="L"
6520 PROTOKOLLOFF$="M"
6530 PRINTOUT$="P"
6540 READON$="R"
6550 TRACK1$="T1"
6560 TRACK2$="T2"
6570 TRACK3$="T3"
6580 WRITEON$="W"
6590 STATUS$="?"
6600 REM ---------------------------------------------------------------------
6610 REM INIT UNIT TO REMOTE MODE
6620 PRINT #1,ESC$;REMON$;CR$;:LINE INPUT #1,INBUFF$:LOCATE 9,79:PRINT INBUFF$;
6630 FOR I = 1 TO 500: NEXT
6640 RETURN
6650 REM *********************************************************************
6660 REM *** RETURN CARD
6670 REM *********************************************************************
6680 PRINT #1,ESC$;RETCARD$;CR$;:LINE INPUT #1,INBUFF$:LOCATE 9,79:PRINT INBUFF$;
6690 RETURN
6700 REM *********************************************************************
6710 REM *** ERROR HANDLER
6720 REM *********************************************************************
6730 LOCATE 21,58:PRINT STRING$(21," "):FOR I=1 TO 100:LOCATE 21,58:PRINT "FEHLER AUFGETRETEN !":NEXT I
6735 RESUME NEXT
6740 REM *********************************************************************
6750 REM *** DELAY FOR PIEPS
6760 REM *********************************************************************
6770 FOR I = 0 TO 500
6780 NEXT
6790 RETURN
6800 REM ********************************************************************
6810 REM *** AENDERUNGSROUTINE
6820 REM ********************************************************************
6830 IN$=INPUT$(1):IF IN$=CHR$(8) THEN GOTO 3190
6840 ON ERROR GOTO 6700
6850 FOR I=1 TO 500:NEXT I:LOCATE 21,58:PRINT STRING$(21," ")
6860 FELD$="A"
6870 LOCATE 20,58:PRINT "DIALOG BOX:          ";
6880 LOCATE 21,58:PRINT "AENDERUNGS-NR.:";:PRINT "  ";:LINE INPUT NUM$
6890 IF NUM$=CHR$(13) THEN FELD$="":GOTO 3190
6900 NUMB=VAL(NUM$)
6910 ON NUMB GOSUB 2380,2400,2420,2440,2460,2480,2500,2560,2571,2573,2575,2577
6920 IF NUMB >12 OR NUMB <1 THEN GOTO 6800
6930 RETURN 7940
6940 REM ********************************************************************
6950 REM *** FELDKONTROLLE
6960 REM *********************************************************************
6970 ON ERROR GOTO 6700
6980 EIN$(I)=INPUT$(1):IF EIN$(I)=CHR$(8) GOTO 3190
6990 RETURN
7000 REM *********************************************************************
7010 REM *** PRINT ETIKETTEN NACH FORMAT MCP
7020 REM *********************************************************************
7030 COLOR 0,7:LOCATE 20.58:PRINT "DIALOG BOX:          ";
7040 COLOR 0,7:LOCATE 21,58:PRINT "AUSDRUCK LŽUFT !     ";
7050 PRINT #1,ESC$;PRINTERON$;CR$;:LINE INPUT #1,INBUFF$
7060 PRINT #1,FS$;WRITE1$;BUFFER1$;CR$;
7070 PRINT #1,FS$;WRITE2$;BUFFER2$;CR$;
7080 PRINT #1,FS$;WRITE3$;BUFFER3$;CR$;
7090 PRINT #1,ESC$;PRINTEROFF$;CR$;:LINE INPUT #1,INBUFF$
7100 LOCATE 9,79:PRINT INBUFF$;
7110 GOSUB 4700
7120 COLOR 7,0:LOCATE 21,58:PRINT "AUSDRUCK FERTIG !    ";
7130 RETURN
7140 REM *********************************************************************
7150 REM *** ETIKETTEN-AUSDRUCK šBER PAR.-DRUCKER
7160 REM *********************************************************************
7170 COLOR 0,7:LOCATE 20,58:PRINT "DIALOG BOX:          ";
7180 COLOR 0,7:LOCATE 21,58:PRINT "AUSDRUCK LŽUFT !     ";
7190 REM LPRINT CHR$(10);
7200 LPRINT "   ";PATNAME$;"      ";GEBDAT$;"   ";GESCHL$;"    ";KLASSE$;"  ";STAT$;"  ";ZI$;"  ";TINTERN$;" ";PATNUM$;
7210 GOSUB 6740:GOSUB 6740
7220 LPRINT CHR$(13);
7230 LPRINT "   ";VORNAME$;
7240 GOSUB 6740:GOSUB 6740
7250 LPRINT CHR$(13);
7254 LPRINT "   ";STRASSE$;
7256 GOSUB 6740:GOSUB 6740
7258 LPRINT CHR$(13);
7260 LPRINT "   ";ORT$;"      ";EINTRITTDAT$;"   ";ZEIT$;"   ";ABT$;"      ";GARANT$;
7270 GOSUB 6740:GOSUB 6740
7280 LPRINT CHR$(13);
7290 LPRINT "   ";TEL$;
7300 GOSUB 6740:GOSUB 6740
7310 LPRINT CHR$(13);CHR$(13);
7320 LPRINT "   ";BERUF$;"      ";GRUND$;"    ";ZIVILST$;"     ";KONF$;"    ";STEUER$;
7330 GOSUB 6740:GOSUB 6740
7340 LPRINT CHR$(13);CHR$(13);
7350 LPRINT "   ";ARBEITGEB$;"      ";HEIMO$;"          ";FRDAT$;
7360 GOSUB 6740:GOSUB 6740
7370 LPRINT CHR$(13);
7380 LPRINT "   ";B$;
7390 GOSUB 6740:GOSUB 6740
7400 LPRINT CHR$(13);
7410 LPRINT "   ";ATEL$;"      ";NAT$;
7420 GOSUB 6740:GOSUB 6740
7430 LPRINT CHR$(13);CHR$(13);
7440 LPRINT "   ";ANGEH$;"      ";V$;
7450 GOSUB 6740:GOSUB 6740
7460 LPRINT CHR$(13);
7470 LPRINT "   ";H$;"      ";V2$;
7480 GOSUB 6740:GOSUB 6740
7490 LPRINT CHR$(13);
7500 LPRINT "   ";HTEL$;"      ";V3$;
7510 GOSUB 6740:GOSUB 6740
7520 LPRINT CHR$(13);
7530 LPRINT "                                  ";V4$;
7540 GOSUB 6740:GOSUB 6740
7550 LPRINT CHR$(13);CHR$(13);
7590 LPRINT "   ";ARZT$;"      ";W$;
7600 GOSUB 6740:GOSUB 6740
7610 LPRINT CHR$(13);
7620 LPRINT "   ";S2$;" ";W2$;
7630 GOSUB 6740:GOSUB 6740
7640 LPRINT CHR$(13);
7650 LPRINT "   ";S3$;" ";W3$;
7660 GOSUB 6740:GOSUB 6740
7670 LPRINT CHR$(13);
7680 LPRINT "                                  ";W4$;
7690 GOSUB 6740:GOSUB 6740
7700 LPRINT CHR$(13);CHR$(13);
7710 LPRINT "   ";T$;" ";X$;
7720 GOSUB 6740:GOSUB 6740
7730 LPRINT CHR$(13);
7740 LPRINT "   ";T2$;" ";X2$;
7750 GOSUB 6740:GOSUB 6740
7760 LPRINT CHR$(13);
7770 LPRINT "   ";T3$;" ";X3$;
7771 LPRINT CHR$(13);
7772 LPRINT "                                  ";X4$;
7773 GOSUB 6740:GOSUB 6740
7774 LPRINT CHR$(13);CHR$(13);
7775 LPRINT "   ";U$;" ";ZUSTELL$;
7776 GOSUB 6740:GOSUB 6740
7777 LPRINT CHR$(13);
7778 LPRINT "   ";U2$;" ";Z$;
7779 GOSUB 6740:GOSUB 6740
7780 LPRINT CHR$(13);
7781 LPRINT "   ";U3$;" ";ZTEL$;
7782 GOSUB 6740:GOSUB 6740
7783 LPRINT CHR$(13);
7785 FOR I=1 TO 2:LPRINT CHR$(10):NEXT I
7789 LPRINT CHR$(27);CHR$(38);CHR$(108);CHR$(48);CHR$(72)
7790 LOCATE 9,79:PRINT INBUFF$;
7800 GOSUB 4700
7810 COLOR 7,0:LOCATE 21,58:PRINT "AUSDRUCK FERTIG !    ";
7820 RETURN
7830 REM *********************************************************************
7840 REM *** AENDERUNGEN J/N (3.SEITE)
7850 REM *********************************************************************
7860 LOCATE 9,58:PRINT "STATUS BOX:          ";
7870 LOCATE 20,58:PRINT "DIALOG BOX:          ";
7880 LOCATE 21,58:PRINT STRING$(21," ")
7890 LOCATE 21,58:PRINT "AENDERUNGEN? (J/N) ";:PRINT " ";:LINE INPUT A$
7900 REM LOCATE 23,58:PRINT "STATUS BOX:          ";
7910 IF A$="N" OR A$="n" THEN RETURN
7920 IF A$="J" OR A$="j" THEN GOSUB 8470 ELSE GOTO 7890
7930 RETURN
7940 REM *********************************************************************
7950 REM *** AENDERUNGEN J/N
7960 REM *********************************************************************
7970 LOCATE 21,58:PRINT STRING$(21," ")
7980 LOCATE 21,58:PRINT "AENDERUNGEN? (J/N) ";:PRINT " ";:LINE INPUT A$
7990 IF A$="N" OR A$="n" THEN RETURN
8000 IF A$="J" OR A$="j" THEN GOSUB 6850 ELSE GOTO 7980
8010 RETURN
8020 REM **********************************************************************
8030 REM *** AENDERUNGEN J/N (2.SEITE)
8040 REM **********************************************************************
8050 LOCATE 9,58:PRINT "STATUS BOX:          ";
8060 LOCATE 20,58:PRINT "DIALOG BOX:          ";
8070 LOCATE 21,58:PRINT STRING$(21," ")
8080 LOCATE 21,58:PRINT "AENDERUNGEN? (J/N) ";:PRINT " ";:LINE INPUT A$
8090 REM LOCATE 23,58:PRINT "STATUS BOX:          ";
8100 IF A$="N" OR A$="n" THEN RETURN
8110 IF A$="J" OR A$="j" THEN GOSUB 8330 ELSE GOTO 8080
8120 RETURN
8130 REM *********************************************************************
8140 REM *** PRUEFZIFFER-RECHNUNG
8150 REM *********************************************************************
8160 QUER=0
8170 PATNUM=VAL(PATNUM$)
8180 FOR I=1 TO 9
8190 MUL$(I) = MID$(PATNUM$,I,1)
8200 MUL(I) = VAL(MUL$(I))
8210 IF I=1 THEN FAK=2 ELSE IF I=2 THEN FAK=7 ELSE IF I=3 THEN FAK=6 ELSE IF I=4 THEN FAK=5 ELSE IF I=5 THEN FAK=4 ELSE IF I=6 THEN FAK=0 ELSE IF I=7 THEN FAK=3 ELSE IF I=8 THEN FAK=2 ELSE IF I=9 THEN FAK=0
8220 EMUL(I)=MUL(I)*FAK:QUER=QUER+EMUL(I)
8230 NEXT I
8240 QSUM=QUER/10:QSUM$=STR$(QSUM):REST$=RIGHT$(QSUM$,1):REST=VAL(REST$)
8250 ZEHN=10:PZ=ZEHN-REST:PZ$=STR$(PZ)
8260 PATNUM$=LEFT$(PATNUM$,9):PATNUM$=PATNUM$+RIGHT$(PZ$,1)
8270 RETURN
8280 REM *********************************************************************
8290 REM *** AENDERUNGSROUTINE 2
8300 REM *********************************************************************
8310 IN$=INPUT$(1):IF IN$=CHR$(8) THEN GOTO 3190
8320 ON ERROR GOTO 6700
8330 LOCATE 21,58:PRINT STRING$(21," ")
8340 FELD$="A"
8350 LOCATE 20,58:PRINT "DIALOG BOX:          ";
8360 LOCATE 21,58:PRINT "AENDERUNGS-NR.:";:PRINT "  ";:LINE INPUT NUM$
8370 IF NUM$=CHR$(13) THEN FELD$="":GOTO 3190
8380 NUMB=VAL(NUM$)
8390 ON NUMB GOSUB 8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,2620,2640,2660,2680,2700,2720,2740,2760,2780,2800,2820
8400 IF NUMB >23 OR NUMB <13 THEN GOTO 8290
8410 RETURN 8020
8420 REM ********************************************************************
8430 REM *** AENDERUNGSROUTINE 3
8440 REM ********************************************************************
8450 IN$=INPUT$(1):IF IN$=CHR$(8) THEN GOTO 3190
8460 ON ERROR GOTO 6700
8470 LOCATE 21,58:PRINT STRING$(21," ")
8480 FELD$="A"
8490 LOCATE 20,58:PRINT "DIALOG BOX:          ";
8500 LOCATE 21,58:PRINT "AENDERUNGS-NR.:";:PRINT "  ";:LINE INPUT NUM$
8510 IF NUM$=CHR$(13) THEN FELD$="":GOTO 3190
8520 NUMB=VAL(NUM$)
8530 ON NUMB GOSUB 8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,2940,2960,2980,3000,3020,3040,3060,3080,3100,3120
8540 IF NUMB >33 OR NUMB <24 THEN GOTO 8460
8550 RETURN 7830
8560 REM ********************************************************************
8570 RETURN
8580 REM ********************************************************************
9000 REM *** AENDERUNG J/N (4.SEITE)
9010 REM ********************************************************************
9020 LOCATE 9,58:PRINT "STATUS BOX:          ";
9030 LOCATE 20,58:PRINT "DIALOG BOX:          ";
9040 LOCATE 21,58:PRINT STRING$(21," ")
9050 LOCATE 21,58:PRINT "AENDERUNGEN? (J/N) ";:PRINT " ";:LINE INPUT A$
9060 IF A$="N" OR A$="n" THEN RETURN
9070 IF A$="J" OR A$="j" THEN GOSUB 9140 ELSE GOTO 9050
9080 RETURN
9090 REM ********************************************************************
9100 REM AENDERUNGSROUTINE 4
9110 REM ********************************************************************
9120 IN$=INPUT$(1):IF IN$=CHR$(8) THEN GOTO 3190
9130 ON ERROR GOTO 6700
9140 LOCATE 21,58:PRINT STRING$(21," ")
9150 FELD$="A"
9160 LOCATE 20,58:PRINT "DIALOG BOX:          ";
9170 LOCATE 21,58:PRINT "AENDERUNGS-NR.:";:PRINT "  ";:LINE INPUT NUM$
9180 IF NUM$=CHR$(13) THEN FELD$="":GOTO 3190
9190 NUMB=VAL(NUM$)
9200 ON NUMB GOSUB 8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,8570,3142,3144,3146,3148,3150,3152,3154,3156,3158,3160,3162,3164
9210 IF NUMB >45 OR NUMB <34 THEN GOTO 9100
9220 RETURN 9000
9230 REM *********************************************************************
9300 REM *** AENDERUNGEN J/N (5.SEITE)
9310 REM *********************************************************************
9320 LOCATE 9,58:PRINT "STATUS BOX:          ";
9330 LOCATE 20,58:PRINT "DIALOG BOX:          ";
9340 LOCATE 21,58:PRINT STRING$(21," ")
9350 LOCATE 21,58:PRINT "AENDERUNGEN? (J/N) ";:PRINT " ";:LINE INPUT A$
9360 IF A$="N" OR A$="n" THEN RETURN
9370 IF A$="J" OR A$="j" THEN GOSUB 9440 ELSE GOTO 9350
9380 RETURN
9390 REM *********************************************************************
9400 REM *** AENDERUNGSROUTINE 5
9410 REM *********************************************************************
9420 IN$=INPUT$(1):IF IN$=CHR$(8) THEN GOTO 3190
9430 ON ERROR GOTO 6700
9440 LOCATE 21,58:PRINT STRING$(21," ")
9450 FELD$="A"
9460 LOCATE 20,58:PRINT "DIALOG BOX:          ";
9470 LOCATE 21,58:PRINT "AENDERUNGS-NR.:";:PRINT "  ";:LINE INPUT NUM$
9480 IF NUM$=CHR$(13) THEN FELD$="":GOTO 3190
9481 IF NUM$="46" THEN NUM$="1"
9482 IF NUM$="47" THEN NUM$="2"
9483 IF NUM$="48" THEN NUM$="3"
9484 IF NUM$="49" THEN NUM$="4"
9485 IF NUM$="50" THEN NUM$="5"
9486 IF NUM$="51" THEN NUM$="6"
9487 IF NUM$="52" THEN NUM$="7"
9488 IF NUM$="53" THEN NUM$="8"
9489 IF NUM$="54" THEN NUM$="9"
9490 NUMB=VAL(NUM$)
9504 ON NUMB GOSUB 3168,3170,3172,3174,3176,3178,3180,3182,3184
9510 IF NUMB >9 OR NUMB <1 THEN GOTO 9400
9520 RETURN 9300
9530 REM *********************************************************************
